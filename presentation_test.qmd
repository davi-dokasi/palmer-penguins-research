---
title: Desvendando o Mundo dos Penguins com o Dataset Palmer Penguins üêß
title-slide-attributes:
    data-background-image: bg_img/penguins_bg.png
    data-background-size: contain
    data-background-opacity: "0.35"

format: 
  revealjs:
    logo: bg_img/tux.png
    footer: Davi Augusto, Diogo Bolzan, Jo√£o Arend, Luan Frederico
    theme: [default, dd.scss]
    
---
```{r inicial, include=FALSE, warning=FALSE}

#Bibliotecas Usadas:
library(readr)
library(dplyr)
library(gridExtra)
library(patchwork)
library(ggplot2)
library(magick)
library(tidyr)
library(kableExtra)

# DOCUMENTA√á√ÉO DO QUARTO https://quarto.org/docs/presentations/revealjs/

#Carregando o Data Base Penguins:
penguins_db <- read_csv("penguins.csv")

# Header para tabelas knit do database original
penguins_db_header <- c("Index", "Specie",
                        "Island", "Bill Length (mm)",
                        "Bill Depth (mm)", "Flipper Length (mm)",
                        "Body Mass (g)", "Sex", "Year")

#Criando um subset para cada esp√©cie:
species_unique <- unique(penguins_db$species)
islands_unique <- unique(penguins_db$island)
nrows_species <- c()
nrows_species_male <- c()
nrows_species_female <- c()

for (spec in species_unique) {
  # Banco de dados
  subset_name <- paste("species_separadas_", tolower(spec), sep = "")
  assign(subset_name, penguins_db[penguins_db$species == spec, ])
  # N√∫mero de registros por esp√©cie
  nrows_name <- paste("nrows_", tolower(spec), sep = "")
  assign(nrows_name, nrow(penguins_db[penguins_db$species == spec, ]))

  nrows_species <- c(nrows_species,
                     nrow(penguins_db[penguins_db$species == spec, ]))

  nrows_species_male <- c(nrows_species_male,
                          nrow(penguins_db[penguins_db$species == spec &
                                             penguins_db$sex == "male", ]))

  nrows_species_female <- c(nrows_species_female,
                            nrow(penguins_db[penguins_db$species == spec &
                                               penguins_db$sex == "female", ]))
}

species_separadas_adelie_sem_na <- na.omit(species_separadas_adelie)
species_separadas_chinstrap_sem_na <- na.omit(species_separadas_chinstrap)
species_separadas_gentoo_sem_na <- na.omit(species_separadas_gentoo)

media_adelie <- colMeans(species_separadas_adelie_sem_na[, c("bill_length_mm", "bill_depth_mm", "flipper_length_mm", "body_mass_g")], na.rm = TRUE)
media_chinstrap <- colMeans(species_separadas_chinstrap_sem_na[, c("bill_length_mm", "bill_depth_mm", "flipper_length_mm", "body_mass_g")], na.rm = TRUE)
media_gentoo <- colMeans(species_separadas_gentoo_sem_na[, c("bill_length_mm", "bill_depth_mm", "flipper_length_mm", "body_mass_g")], na.rm = TRUE)

names(media_adelie)[names(media_adelie) == "bill_length_mm"] <- "M√©dias"
names(media_gentoo)[names(media_gentoo) == "bill_length_mm"] <- "M√©dias"
names(media_chinstrap)[names(media_chinstrap) == "bill_length_mm"] <- "M√©dias"

#####################
media_adelie <- data.frame(
  "bill_length_mm_mean" = media_adelie["M√©dias"],
  "bill_depth_mm_mean" = media_adelie["bill_depth_mm"],
  "flipper_length_mm_mean" = media_adelie["flipper_length_mm"],
  "body_mass_g_mean" = media_adelie["body_mass_g"]
)

media_chinstrap <- data.frame(
  "bill_length_mm_mean" =media_chinstrap["M√©dias"],
  "bill_depth_mm_mean" = media_chinstrap["bill_depth_mm"],
  "flipper_length_mm_mean" = media_chinstrap["flipper_length_mm"],
  "body_mass_g_mean" = media_chinstrap["body_mass_g"]
)

media_gentoo <- data.frame(
  "bill_length_mm_mean" = media_gentoo["M√©dias"],
  "bill_depth_mm_mean" = media_gentoo["bill_depth_mm"],
  "flipper_length_mm_mean" = media_gentoo["flipper_length_mm"],
  "body_mass_g_mean" = media_gentoo["body_mass_g"]
)

```
# Introdu√ß√£o

## Sobre o Dataset 

::: columns
::: {.column width="55%"}
- Al√©m de um banco de dados no Kaggle, √© um banco de dados "verdadeiro" e nativo do R

- Os dados foram coletados e disponibilizados pela Dra. Kristen Gorman e pela Esta√ß√£o Palmer, Ant√°rtica, LTER (Long Term Ecological Research), membro da Rede de Pesquisa Ecol√≥gica de Longo Prazo.

- 344 Pinguins

- 3 esp√©cies (Ad√©lie, chinstrap e gentoo)
:::

::: {.column width="45%"}
![](bg_img/kristen.jpg){.absolute  width="400" height="400"}

:::
:::

## Contexto

::: columns
::: {.column width="55%"}

- Coletados em Palmer Station, na Pen√≠nsula Ant√°rtica, esses dados oferecem insights valiosos sobre tr√™s esp√©cies de pinguins: Ad√©lie, Pap√∫a e Gentoo. Cada linha neste conjunto de dados √© mais do que um simples registro; √© uma hist√≥ria de sobreviv√™ncia, reprodu√ß√£o e evolu√ß√£o em um dos ambientes mais extremos do planeta.
:::

::: {.column width="45%"}
![](bg_img/madagascar.png){.absolute  width="450" height="300"}
:::
:::

## Apresentando o dataset

::: columns
::: {.column width="60%"}
Exemplo de uma pequena amostra aleat√≥ria do dataset:

```{r}

knitr::kable(penguins_db[sample(nrow(penguins_db), 8), 2:ncol(penguins_db)],
  col.names = penguins_db_header[-1],
  align = "ccrrrrcc"
)  %>%
    kable_styling(full_width = F, font_size = 17)
```
:::
::: {.column width="40%"}

![](bg_img/var_explanation.png)

:::
:::

## Sobre as esp√©cies
::: columns
::: {.column width="33%" .incremental}
- Ad√©lie 

- ![](bg_img/adelie.jpg){width="200" height="200"}

```{r attr.output='.incremental'}

knitr::kable(t(media_adelie)) %>%
  kable_styling(full_width = F, position = "center", font_size = 18)

```

:::
::: {.column width="33%" .incremental}
- Chinstrap

- ![](bg_img/chinstrap.jpeg){width="200" height="200"}

```{r attr.output='.incremental'}
knitr::kable(t(media_chinstrap)) %>%
  kable_styling(full_width = F, position = "center", font_size = 18)

```
:::
::: {.column width="33%" .incremental}
- Gentoo

- ![](bg_img/gentoo.jpeg){width="200" height="200"}

```{r attr.output='.incremental'}
knitr::kable(t(media_gentoo)) %>%
  kable_styling(full_width = F, position = "center", font_size = 18)

```
:::
:::

## Vis√£o Geral

::: columns

Iniciamos a an√°lise com uma vis√£o geral sobre o dataset escolhido: 

::: {.column width="50%"}

![](bg_img/var_explanation.png)
:::

::: {.column width="50%"}
```{r An√°lise Explorat√≥ria,include=FALSE, warning=FALSE}
vars <- c(
  "Total de observa√ß√µes",
  "Quant. de machos",
  "Quant. de f√™meas",
  "Menor comprimento do bico",
  "Maior comprimento do bico",
  "Menor profundidade do bico",
  "Maior profundidade do bico",
  "Menor comprimento da nadadeira",
  "Maior comprimento da nadadeira",
  "Menor massa corporal",
  "Maior massa corporal"
)

species_resum <- penguins_db %>%
  group_by(species) %>%
  summarize(nrows_species = n(),
    male_count = sum(ifelse(sex == "male", 1, 0), na.rm = TRUE),
    female_count = sum(ifelse(sex == "female", 1, 0), na.rm = TRUE),
    bill_length_min = min(bill_length_mm, na.rm = TRUE),
    bill_length_max = max(bill_length_mm, na.rm = TRUE),
    bill_depth_min = min(bill_depth_mm, na.rm = TRUE),
    bill_depth_max = max(bill_depth_mm, na.rm = TRUE),
    flipper_length_min = min(flipper_length_mm, na.rm = TRUE),
    flipper_length_max = max(flipper_length_mm, na.rm = TRUE),
    body_mass_min = min(body_mass_g, na.rm = TRUE),
    body_mass_max = max(body_mass_g, na.rm = TRUE),
  ) %>%
  rename(
    "Total de observa√ß√µes" = nrows_species,
    "Quant. de machos" = male_count,
    "Quant. de f√™meas" = female_count,
    "Menor comprimento do bico (mm)" = bill_length_min,
    "Maior comprimento do bico (mm)" = bill_length_max,
    "Menor profundidade do bico (mm)" = bill_depth_min,
    "Maior profundidade do bico (mm)" = bill_depth_max,
    "Menor comprimento da nadadeira (mm)" = flipper_length_min,
    "Maior comprimento da nadadeira (mm)" = flipper_length_max,
    "Menor massa corporal (g)" = body_mass_min,
    "Maior massa corporal (g)" = body_mass_max
  )
```

```{r}
knitr::kable(t(species_resum[, 2:ncol(species_resum)]),
             col.names = c(species_resum$species)) %>%
  kable_styling(font_size = 17.5)
```
:::
:::

# Pesquisas

## Estudo Adelie
Com o objetivo de c√°lcular o intervalo de confian√ßa para a esp√©cie Adelie, criamos um data base com apenas as observa√ß√µes da esp√©cie de interesse nele, abaixo est√° o resumo:

::: {.panel-tabset}

### As primeiras 6 observa√ß√µes:

```{r Data Base Explica√ß√£o, warning=FALSE}

knitr::kable(head(species_separadas_adelie[, 2:ncol(species_separadas_adelie)]),
  col.names = penguins_db_header[-1],
  align = "ccrrrrcc"
) %>%
  kable_styling(font_size = 20)
```

### Intervalo de confian√ßa:


```{r Curva Te√≥rica Explica√ß√£o, warning=FALSE, message=FALSE}

set.seed(1234)

#Histrograma da vari√°vel Flipper Lenght
flipper_lenght_adelie <- ggplot(data = data.frame(x = species_separadas_adelie$flipper_length_mm),
       aes(x = x)) +
  geom_histogram(color = "#00a6ff") +
  labs(title = "Histograma dos dados da Amostra",
       x = "Comprimento da Nadadeira (mm)",
       y = "Frequ√™ncia")

# √önica maneira que eu encontrei de fazer o gr√°fico ficar de maneira correta
# no tabs...
# To salvando em imagem o gr√°fico, e adicionando em baixo
# Histograma dos dados da vari√°vel Comprimento da Nadadeira (mm)
ggsave("flipper_lenght_adelie.png", plot = flipper_lenght_adelie)

```
![](flipper_lenght_adelie.png){width="1000" height="500"}

::: footer
.
:::
:::